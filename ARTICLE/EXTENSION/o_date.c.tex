% Remember to use the lgrind style

\File{}{0000}{N/A}{00}{00:00}{0}
\L{\LB{\K{\#include}_\<\V{time}.\V{h}\>}}
\L{\LB{\K{\#include}_\<\V{signal}.\V{h}\>}}
\L{\LB{\K{\#include}_\<\V{unistd}.\V{h}\>}}
\L{\LB{\K{\#include}_\<\V{fcntl}.\V{h}\>}}
\L{\LB{\K{\#include}_\<\V{sys}\1\V{wait}.\V{h}\>}}
\L{\LB{\K{\#include}_\S{}\3u\_xt\_interface.h\3\SE{}}}
\L{\LB{\K{\#include}_\S{}\3o\_objet.h\3\SE{}}}
\L{\LB{}}
\L{\LB{\K{struct}_\V{dada}}}
\L{\LB{\{}}
\L{\LB{__\K{int}_\V{secondes}_;}\Tab{32}{\C{}\1\*_Nombre_de_secondes_depuis_la_création_\*\1\CE{}}}
\L{\LB{__\K{int}_\V{start}_;}\Tab{32}{\C{}\1\*_Date_de_création_\*\1\CE{}}}
\L{\LB{__\K{int}____________\V{pid}_;}\Tab{32}{\C{}\1\*_Pour_pouvoir_tuer_date_\*\1\CE{}}}
\L{\LB{__\K{int}____________\V{pipe}[\N{2}]_;}\Tab{32}{\C{}\1\*_Pour_lire_la_date_\*\1\CE{}}}
\L{\LB{\}_;}}
\L{\LB{\C{}\1\*_Cette_fonction_est_appelée_chaque_fois_qu\4il_y_a_quelque_chose}}
\L{\LB{_\*_à_lire_dans_le_fichier_\*\1\CE{}}}
\L{\LB{\Proc{chose\_a\_lire}\K{static}_\V{Parcour}_\V{chose\_a\_lire}(\K{void}\*_\V{objet},_\K{int}_\V{fildes})}}
\L{\LB{\{}}
\L{\LB{__\V{time\_t}_\V{date}_;}}
\L{\LB{__\K{struct}_\V{dada}_\*\V{o}_;}}
\L{\LB{}}
\L{\LB{__\V{o}_=_\V{objet}_;}}
\L{\LB{__\V{read}(\V{o}\-\!\>\V{pipe}[\N{0}],\&\V{date},\K{sizeof}(\V{date}))_;_\C{}\1\*_Lit_la_date_\*\1\CE{}}}
\L{\LB{__\V{o}\-\!\>\V{secondes}_=_\V{time}(\V{NULL})_\-_\V{o}\-\!\>\V{start}_;}}
\L{\LB{__\C{}\1\*_D\4habitude_on_indique_pas_que_l\4on_change_des_champs_de_l\4objets.}}
\L{\LB{___\*_En_effet,_le_changement_est_la_conséquence_d\4un_autre_changement}}
\L{\LB{___\*_d\4un_autre_champ.}}
\L{\LB{___\*_Ici,_le_champ_se_modifie_de_lui-même,_il_faut_prévenir_NanoÉdit.}}
\L{\LB{___\*\1\CE{}}}
\L{\LB{__\V{NOTE\_UN\_CHAMP\_CHANGE}(\V{o})_;}}
\L{\LB{__\C{}\1\*}}
\L{\LB{___\*_Il_faut_ensuite_propager_le_changement_pour_tout_mettre_à_jour.}}
\L{\LB{___\*\1\CE{}}}
\L{\LB{__\K{if}_(_\V{ACTIF}(\V{o})_)_\C{}\1\*_Pas_tout_le_temps_sinon_c\4est_trop_consommateur_CPU_\*\1\CE{}}}
\L{\LB{____\V{o\_appel\_changement\_sommet}(\V{o})_;}}
\L{\LB{__\K{return}(\V{Continue})_;}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\Proc{changement}\K{static}_\K{void}_\V{changement}(\K{struct}_\V{dada}_\*\V{o})}}
\L{\LB{\{}}
\L{\LB{__\K{if}_(_\V{o}\-\!\>\V{pid}_\|\,\|_\V{CREATION}(\V{o})_)}\Tab{40}{\C{}\1\*_Le_processus_est_déjà_lancé_\*\1\CE{}}}
\L{\LB{____\K{return}_;}}
\L{\LB{}}
\L{\LB{__\V{pipe}(\V{o}\-\!\>\V{pipe})_;}\Tab{32}{\C{}\1\*_Ouvre_le_fichier_de_communication_\*\1\CE{}}}
\L{\LB{__\V{o}\-\!\>\V{pid}_=_\V{fork}()_;}\Tab{32}{\C{}\1\*_Création_d\4un_nouveau_processus_\*\1\CE{}}}
\L{\LB{__\K{if}_(_\V{o}\-\!\>\V{pid}_)}}
\L{\LB{____\{}}
\L{\LB{______\C{}\1\*_Pere_:}}
\L{\LB{_______\*_On_demande_de_nous_prévenir_en_cas}}
\L{\LB{_______\*_d\4arrivé_de_données_dans_le_pipe._\*\1\CE{}}}
\L{\LB{______\V{xt\_ajoute\_fichier}(\V{o},_\V{chose\_a\_lire},_\V{o}\-\!\>\V{pipe}[\N{0}])_;}}
\L{\LB{______\V{o}\-\!\>\V{start}_=_\V{time}(\V{NULL})_;}}
\L{\LB{____\}}}
\L{\LB{__\K{else}}}
\L{\LB{____\{}}
\L{\LB{______\V{time\_t}_\V{date}_;}}
\L{\LB{______\C{}\1\*_fils_\*\1\CE{}}}
\L{\LB{______\K{for}(;;)}\Tab{32}{\C{}\1\*_Le_process_est_tué_par_un_kill_\*\1\CE{}}}
\L{\LB{}\Tab{8}{\{}}
\L{\LB{}\Tab{8}{__\V{time}(\&\V{date})_;}\Tab{32}{\C{}\1\*_Récupere_le_temps_\*\1\CE{}}}
\L{\LB{}\Tab{8}{__\V{write}(\V{o}\-\!\>\V{pipe}[\N{1}],_\&\V{date},\K{sizeof}(\V{date}))_;_\C{}\1\*_Envoit_le_temps_\*\1\CE{}}}
\L{\LB{}\Tab{8}{__\V{sleep}(\N{1})_;}\Tab{32}{\C{}\1\*_Attend_un_peu_\*\1\CE{}}}
\L{\LB{}\Tab{8}{\}}}
\L{\LB{____\}}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\Proc{destruction}\K{static}_\K{void}_\V{destruction}(\K{struct}_\V{dada}_\*\V{o})}}
\L{\LB{\{}}
\L{\LB{__\K{int}_\V{status}_;}}
\L{\LB{}}
\L{\LB{__\K{if}_(_\V{o}\-\!\>\V{pid}_)}}
\L{\LB{____\{}}
\L{\LB{______\V{kill}(\V{o}\-\!\>\V{pid},\V{SIGTERM})_;}\Tab{32}{\C{}\1\*_On_tue_le_processus_\*\1\CE{}}}
\L{\LB{______\V{waitpid}(\V{o}\-\!\>\V{pid},\&\V{status},\N{0})_;_\C{}\1\*_On_attend_sa_mort_\*\1\CE{}}}
\L{\LB{______\V{close}(\V{o}\-\!\>\V{pipe}[\N{0}])_;}}
\L{\LB{______\V{close}(\V{o}\-\!\>\V{pipe}[\N{1}])_;}}
\L{\LB{______\V{xt\_enleve\_fichier}(\V{o},_\V{chose\_a\_lire},_\V{o}\-\!\>\V{pipe}[\N{0}])_;}}
\L{\LB{______\V{o}\-\!\>\V{pid}_=_\N{0}_;}}
\L{\LB{____\}}}
\L{\LB{\}}}
\L{\LB{}}
\L{\LB{\Proc{CLASSE}\V{CLASSE}(\V{date},_\K{struct}_\V{dada},}}
\L{\LB{\Proc{CHAMP}_______\V{CHAMP}(\V{secondes},_\V{L\_nombre}_\V{P\_entier}_\V{Affiche})}}
\L{\LB{\Proc{CHANGEMENT}_______\V{CHANGEMENT}(\V{changement})}}
\L{\LB{\Proc{DESTRUCTION}_______\V{DESTRUCTION}(\V{destruction})}}
\L{\LB{_______)}}
